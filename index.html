<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeMaster: Trading Simulation Dashboard</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #222;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }
        #dashboard {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80%;
            margin-top: 20px;
        }
        #chartArea {
            width: 100%;
            height: 400px;
            background-color: #333;
            border: 1px solid #444;
            position: relative;
        }
        canvas {
            width: 100%;
            height: 100%;
            background-color: #222;
        }
        .controls {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 20px;
        }
        .trade-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #444;
            padding: 20px;
            border-radius: 10px;
        }
        .trade-panel label {
            margin-bottom: 10px;
        }
        .trade-panel input {
            width: 100px;
            padding: 5px;
            margin-left: 10px;
        }
        .trade-panel button {
            padding: 10px 20px;
            margin-top: 10px;
        }
        .stats {
            margin-top: 20px;
            font-size: 18px;
        }
        .trade-history {
            margin-top: 20px;
            width: 100%;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #444;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        select {
            padding: 10px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div id="dashboard">
    <div id="chartArea">
        <canvas id="marketCanvas"></canvas>
    </div>
    <div class="controls">
        <select id="marketSelect">
            <option value="Stock A">Stock A</option>
            <option value="Crypto B">Crypto B</option>
            <option value="Forex C">Forex C</option>
        </select>
        <div class="trade-panel">
            <label>Stop Loss: <input type="number" id="stopLoss" value="10"></label>
            <label>Take Profit: <input type="number" id="takeProfit" value="20"></label>
            <label>Risk to Reward: <input type="number" id="riskReward" value="2"></label>
            <button id="buyButton">Buy</button>
            <button id="sellButton">Sell</button>
        </div>
    </div>
    <div class="stats">
        <p id="balance">Balance: $10,000</p>
        <p id="message">Select a market and place your trade.</p>
    </div>
    <div class="trade-history">
        <h3>Trade History</h3>
        <table id="historyTable">
            <thead>
                <tr>
                    <th>Market</th>
                    <th>Action</th>
                    <th>Entry Price</th>
                    <th>Exit Price</th>
                    <th>Profit/Loss</th>
                </tr>
            </thead>
            <tbody id="historyBody">
                <!-- Trade history will be dynamically added here -->
            </tbody>
        </table>
    </div>
</div>

<script>
    const canvas = document.getElementById('marketCanvas');
    const ctx = canvas.getContext('2d');

    const marketSelect = document.getElementById('marketSelect');
    const buyButton = document.getElementById('buyButton');
    const sellButton = document.getElementById('sellButton');
    const balanceDisplay = document.getElementById('balance');
    const messageDisplay = document.getElementById('message');
    const stopLossInput = document.getElementById('stopLoss');
    const takeProfitInput = document.getElementById('takeProfit');
    const riskRewardInput = document.getElementById('riskReward');
    const historyBody = document.getElementById('historyBody');

    let balance = 10000;
    let currentPrice = 100;  // Start with a default price
    let tradeHistory = [];
    let selectedMarket = marketSelect.value;

    function simulateMarketData() {
        // Simulate market price fluctuations
        currentPrice += (Math.random() - 0.5) * 2;  // Random price changes
        if (currentPrice < 90) currentPrice = 90;   // Floor price
        if (currentPrice > 110) currentPrice = 110; // Ceiling price
        updateMarket(currentPrice);
    }

    // Function to update the market with new price data
    function updateMarket(price) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw price line
        ctx.beginPath();
        ctx.moveTo(0, canvas.height - price);
        ctx.lineTo(canvas.width, canvas.height - price);
        ctx.strokeStyle = '#00ff00';
        ctx.stroke();

        // Display current price
        ctx.fillStyle = '#00ff00';
        ctx.font = '20px Arial';
        ctx.fillText('Price: $' + price.toFixed(2), 10, 30);
    }

    marketSelect.addEventListener('change', () => {
        selectedMarket = marketSelect.value;
        messageDisplay.textContent = `Selected Market: ${selectedMarket}`;
        resetMarket();
    });

    function resetMarket() {
        currentPrice = 100;
        updateMarket(currentPrice);
    }

    // Handle buy action
    buyButton.addEventListener('click', () => {
        executeTrade(true);
    });

    // Handle sell action
    sellButton.addEventListener('click', () => {
        executeTrade(false);
    });

    function executeTrade(isBuy) {
        const entryPrice = currentPrice;
        const stopLoss = parseFloat(stopLossInput.value);
        const takeProfit = parseFloat(takeProfitInput.value);
        const riskReward = parseFloat(riskRewardInput.value);
        const tradeEntry = {
            market: selectedMarket,
            action: isBuy ? 'Buy' : 'Sell',
            entryPrice: entryPrice,
            stopLoss: isBuy ? entryPrice - stopLoss : entryPrice + stopLoss,
            takeProfit: isBuy ? entryPrice + takeProfit : entryPrice - takeProfit,
            timestamp: new Date(),
        };

        simulateMarketData();  // Simulate market movement

        let exitPrice = currentPrice;
        let profit = 0;

        if (isBuy) {
            if (exitPrice >= tradeEntry.takeProfit) {
                profit = takeProfit * 100;
            } else if (exitPrice <= tradeEntry.stopLoss) {
                profit = -stopLoss * 100;
            } else {
                profit = (exitPrice - entryPrice) * 100;
            }
        } else {
            if (exitPrice <= tradeEntry.takeProfit) {
                profit = takeProfit * 100;
            } else if (exitPrice >= tradeEntry.stopLoss) {
                profit = -stopLoss * 100;
            } else {
                profit = (entryPrice - exitPrice) * 100;
            }
        }

        tradeEntry.exitPrice = exitPrice;
        tradeEntry.profit = profit;
        tradeHistory.push(tradeEntry);

        balance += profit;
        balanceDisplay.textContent = 'Balance: $' + balance.toFixed(2);

        addTradeToHistory(tradeEntry);

        // Show the trade result
        messageDisplay.textContent = profit >= 0 ? `Profit: $${profit.toFixed(2)}` : `Loss: $${(-profit).toFixed(2)}`;
    }

    function addTradeToHistory(trade) {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${trade.market}</td>
            <td>${trade.action}</td>
            <td>${trade.entryPrice.toFixed(2)}</td>
            <td>${trade.exitPrice.toFixed(2)}</td>
            <td>${trade.profit >= 0 ? '$' + trade.profit.toFixed(2) : '-$' + (-trade.profit).toFixed(2)}</td>
        `;
        historyBody.appendChild(row);
    }

    // Simulate market data updates
    setInterval(simulateMarketData, 2000); // Update every 2 seconds
</script>

</body>
</html>
